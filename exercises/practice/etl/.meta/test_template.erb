require 'minitest/autorun'
require_relative 'etl'

class EtlTest < Minitest::Test
<% json["cases"].each do |cases| %>
    def test_<%= underscore(cases["description"]) %>
        <%= skip? %> 
        old = {
        <% cases["input"]["legacy"].each do |key, value| -%>
          <%= key %> => <%= value %>,
        <%- end -%>
        }
        expected = {
          <% cases["expected"].each do |key, value| -%>
            '<%= key %>' => <%= value %>,
          <%- end -%>
        }
        assert_equal expected, ETL.transform(old)
    end
    <% end %>
end