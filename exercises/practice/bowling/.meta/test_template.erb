require 'minitest/autorun'
require_relative 'bowling'

class BowlingTest < Minitest::Test
<% json["cases"].each do |cases| %>
    def test_<%= underscore(cases["description"]) %>
        <%= skip? %> 
        game = Game.new
        rolls = <%= cases["input"]["previousRolls"] %>
        rolls.each { |pins| game.roll(pins) }
        <%- if cases["property"] == "score" -%>
            <%- if cases["expected"].is_a?(Hash) && cases["expected"].key?("error") -%>
            assert_raises Game::BowlingError do
              game.score
            end
            <%- else -%>
            assert_equal <%= cases["expected"] %>, game.score
            <%- end -%>
        <%- elsif cases["property"] == "roll" -%>
            assert_raises Game::BowlingError do
                game.roll(<%= cases["input"]["roll"] %>)
            end
        <%- end -%>
    end
<% end %>
end
